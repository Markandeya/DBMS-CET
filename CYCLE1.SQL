/* 1A */


CREATE TABLE CLIENT_MASTER_5353(CLIENT_NO VARCHAR(20) PRIMARY KEY CHECK (CLIENT_NO LIKE 'C%'), NAME VARCHAR(20) NOT NULL, ADDRESS1 VARCHAR(20), ADDRESS2 VARCHAR(20), CITY VARCHAR(20), PINCODE INT, STATE VARCHAR(20), BAL_DUE FLOAT);



CREATE TABLE PRODUCT_MASTER_5353(PRODUCT_NO VARCHAR(20) PRIMARY KEY CHECK(PRODUCT_NO LIKE 'P%'), DESCRIPTION VARCHAR(20) NOT NULL, PROFIT_PERCENT FLOAT, UNIT_MEASURE VARCHAR(20), QTY_ON_HAND INT, REORDER_LVL INT, SELL_PRICE INT, COST_PRICE INT);



CREATE TABLE SALES_MASTER_5353(SALESMAN_NO VARCHAR(20) PRIMARY KEY CHECK(SALESMAN_NO LIKE 'S%'), SALESMAN_NAME VARCHAR(20) NOT NULL, ADDRESS1 VARCHAR(20) NOT NULL, CITY VARCHAR(20), PINCODE INT, STATE VARCHAR(20), SAL_AMT INT NOT NULL CHECK(SAL_AMT >0), TGT_TO_GET INT NOT NULL CHECK(TGT_TO_GET >0), TTD_SALES INT NOT NULL, REMARKS VARCHAR(20));



CREATE TABLE SALES_ORDER_5353(
	ORDER_NO VARCHAR(20) PRIMARY KEY CHECK(ORDER_NO LIKE 'O%'), 
	ORDER_DATE DATE, 
	CLIENT_NO VARCHAR(20),
	DELY_ADDR VARCHAR(20), 
	SALESMAN_NO VARCHAR(20), 
	DELY_TYPE CHAR(1) DEFAULT 'F',
	BILLED_YN CHAR(1), 
	DELY_DATE DATE, 
	ORDER_STATUS VARCHAR(20) CHECK( ORDER_STATUS IN ('IN PROCESS', 'FULFILLED', 'BACKORDER', 'CANCELLED')),
	FOREIGN KEY(CLIENT_NO) REFERENCES CLIENT_MASTER_5353(CLIENT_NO)
);

CREATE TABLE SALES_ORDER_DETAILS_5353(
	ORDER_NO VARCHAR(20),
	PRODUCT_NO VARCHAR(20),
	QTY_ORDERED INT,
	QTY_DISP INT,
	PRODUCT_RATE INT,
	FOREIGN KEY (ORDER_NO) REFERENCES SALES_ORDER_5353(ORDER_NO),
	FOREIGN KEY (PRODUCT_NO) REFERENCES PRODUCT_MASTER_5353(PRODUCT_NO)
);

/* 2 */

--1

INSERT INTO CLIENT_MASTER_5353(CLIENT_NO , NAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, BAL_DUE ) VALUES
('C00001', 'IVAN BAYROSS', 'WANDON', 'WORLI', 'MUMBAI', 450005, 'MAHARASHTRA', 15000);

INSERT INTO CLIENT_MASTER_5353(CLIENT_NO , NAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, BAL_DUE ) VALUES
('C00002', 'VANDANA SHIVA', 'DON STREET', 'BANDRA', 'MADRAS', 780001, 'TAMILNADU', 0);

INSERT INTO CLIENT_MASTER_5353(CLIENT_NO , NAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, BAL_DUE ) VALUES
('C00003', 'PRAMADAJAGUST', 'MANDON', 'DADAR', 'MUMBAI', 450007, 'MAHARASHTRA', 5000);

INSERT INTO CLIENT_MASTER_5353(CLIENT_NO , NAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, BAL_DUE ) VALUES
('C00004', 'BASU NAVINDGI', 'JEROME', 'JUHU', 'MUMBAI', 450009, 'MAHARASHTRA', 0);

INSERT INTO CLIENT_MASTER_5353(CLIENT_NO , NAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, BAL_DUE ) VALUES
('C00005', 'RAVISREEDHARAN', 'DADAR', 'DADRA', 'DELHI', 100003, 'DELHI', 2000);

INSERT INTO CLIENT_MASTER_5353(CLIENT_NO , NAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, BAL_DUE ) VALUES
('C00006', 'RUKMINI', 'ROURK', 'BANDRA', 'MUMBAI', 450002, 'MAHARASHTRA', 0);

--2
INSERT INTO PRODUCT_MASTER_5353(PRODUCT_NO, DESCRIPTION, PROFIT_PERCENT, UNIT_MEASURE, QTY_ON_HAND, REORDER_LVL, SELL_PRICE, COST_PRICE) VALUES
('P00001', '1.44 FLOPPIES', 5, 'PIECE', 100, 20, 525, 500);

INSERT INTO PRODUCT_MASTER_5353(PRODUCT_NO, DESCRIPTION, PROFIT_PERCENT, UNIT_MEASURE, QTY_ON_HAND, REORDER_LVL, SELL_PRICE, COST_PRICE) VALUES
('P03453', 'MONITORS', 6, 'PIECE', 10, 3, 12000, 11280);

INSERT INTO PRODUCT_MASTER_5353(PRODUCT_NO, DESCRIPTION, PROFIT_PERCENT, UNIT_MEASURE, QTY_ON_HAND, REORDER_LVL, SELL_PRICE, COST_PRICE) VALUES
('P45789', 'MOUSE', 5, 'PIECE', 20, 5, 1050, 1000);

INSERT INTO PRODUCT_MASTER_5353(PRODUCT_NO, DESCRIPTION, PROFIT_PERCENT, UNIT_MEASURE, QTY_ON_HAND, REORDER_LVL, SELL_PRICE, COST_PRICE) VALUES
('P44783', 'KEYBOARDS', 5, 'PIECE', 100, 20, 3150, 3050);

INSERT INTO PRODUCT_MASTER_5353(PRODUCT_NO, DESCRIPTION, PROFIT_PERCENT, UNIT_MEASURE, QTY_ON_HAND, REORDER_LVL, SELL_PRICE, COST_PRICE) VALUES
('P45123', 'CD DRIVE', 2, 'PIECE', 10, 3, 5250, 5100);

INSERT INTO PRODUCT_MASTER_5353(PRODUCT_NO, DESCRIPTION, PROFIT_PERCENT, UNIT_MEASURE, QTY_ON_HAND, REORDER_LVL, SELL_PRICE, COST_PRICE) VALUES
('P35412', '540 HDD', 2.5, 'PIECE', 10, 3, 8400, 8000);

--3

INSERT INTO SALES_MASTER_5353 VALUES ('S00001', 'KIRAN', 'A/14', 'WORLI', 450001, 'BOMBAY', 3000, 100, 50, 'GOOD');
INSERT INTO SALES_MASTER_5353 VALUES ('S00002', 'MANEESH', 'J-65', 'NARIMAN', 450001, 'BOMBAY', 3000, 200, 100, 'GOOD');
INSERT INTO SALES_MASTER_5353 VALUES ('S00003', 'RAVI', 'P-7', 'BANDRA', 450003, 'BOMBAY', 3000, 200, 100, 'GOOD');
INSERT INTO SALES_MASTER_5353 VALUES ('S00004', 'ASHISH', 'A/5', 'JUHU', 400041, 'BOMBAY', 3000, 200, 150, 'GOOD');


--4

INSERT INTO SALES_ORDER_5353  VALUES ('O19001', TO_DATE('1996-01-12', 'YYYY-MM-DD'), 'C00001', 'WANDON', 'S00001', 'F', 'N',  TO_DATE('1996-01-20', 'YYYY-MM-DD'), 'IN PROCESS');

INSERT INTO SALES_ORDER_5353  VALUES ('O19002', TO_DATE('1996-01-25', 'YYYY-MM-DD'), 'C00002', 'DON STREET', 'S00002', 'P', 'N',  TO_DATE('1996-01-27', 'YYYY-MM-DD'), 'CANCELLED');

INSERT INTO SALES_ORDER_5353  VALUES ('O46865', TO_DATE('1996-02-18', 'YYYY-MM-DD'), 'C00003', 'MANDON', 'S00003', 'F', 'Y',  TO_DATE('1996-02-20', 'YYYY-MM-DD'), 'FULFILLED');

INSERT INTO SALES_ORDER_5353  VALUES ('O19003', TO_DATE('1996-04-03', 'YYYY-MM-DD'), 'C00001', 'JEROME', 'S00001', 'F', 'Y',  TO_DATE('1996-04-07', 'YYYY-MM-DD'), 'FULFILLED');

INSERT INTO SALES_ORDER_5353  VALUES ('O46866', TO_DATE('1996-05-20', 'YYYY-MM-DD'), 'C00004', 'DADAR', 'S00002', 'P', 'N',  TO_DATE('1996-05-22', 'YYYY-MM-DD'), 'CANCELLED');

INSERT INTO SALES_ORDER_5353  VALUES ('O19008', TO_DATE('1996-05-24', 'YYYY-MM-DD'), 'C00005', 'ROURK', 'S00004', 'F', 'N',  TO_DATE('1996-05-26', 'YYYY-MM-DD'), 'IN PROCESS');

--5

INSERT INTO SALES_ORDER_DETAILS_5353 VALUES ('O19001', 'P00001', 4, 4, 525 );

INSERT INTO SALES_ORDER_DETAILS_5353 VALUES ('O19002', 'P00001', 10, 0, 525 );

INSERT INTO SALES_ORDER_DETAILS_5353 VALUES ('O46865', 'P00001', 10, 10, 525 );

INSERT INTO SALES_ORDER_DETAILS_5353 VALUES ('O46865', 'P03453', 4, 4, 1050 );

INSERT INTO SALES_ORDER_DETAILS_5353 VALUES ('O19003', 'P03453', 2, 2, 1050 );

INSERT INTO SALES_ORDER_DETAILS_5353 VALUES ('O19008', 'P00001', 10, 5, 525 );


/* 1B */


RENAME CLIENT_MASTER_5353 TO CLIENTMASTER_5353;

/* 1C */

ALTER TABLE SALES_ORDER_5353 ADD CONSTRAINT DELYAFTERORDER CHECK (ORDER_DATE < DELY_DATE);


/* 1D */

ALTER TABLE PRODUCT_MASTER_5353 ADD CONSTRAINT COSTNOTZERO CHECK(COST_PRICE>0);

/* 1E */

ALTER TABLE PRODUCT_MASTER_5353 MODIFY COST_PRICE INT NOT NULL;

/* 1F */

ALTER TABLE PRODUCT_MASTER_5353 ADD CONSTRAINT SELLNOTZERO CHECK(SELL_PRICE>0);

/* 3 A */

SELECT SALESMAN_NAME FROM SALES_MASTER_5353 WHERE SALESMAN_NAME LIKE '_A%';

SALESMAN_NAME
--------------------
MANEESH
RAVI

/* 3 B */

SELECT NAME FROM CLIENTMASTER_5353 WHERE NAME LIKE 'R%' AND CITY LIKE 'DELHI';

NAME
--------------------
RAVISREEDHARAN

/* 3 C */

SELECT NAME, ADDRESS1, ADDRESS2 FROM CLIENTMASTER_5353 WHERE STATE IN ('DELHI', 'MAHARASHTRA');

NAME		     ADDRESS1		  ADDRESS2
-------------------- -------------------- --------------------
IVAN BAYROSS	     WANDON		  WORLI
PRAMADAJAGUST	     MANDON		  DADAR
BASU NAVINDGI	     JEROME		  JUHU
RAVISREEDHARAN	     DADAR		  DADRA
RUKMINI 	     ROURK		  BANDRA


/* 3 D */

SELECT * FROM PRODUCT_MASTER_5353 WHERE COST_PRICE > 5000;

PRODUCT_NO	     DESCRIPTION	  PROFIT_PERCENT UNIT_MEASURE	      QTY_ON_HAND REORDER_LVL SELL_PRICE COST_PRICE
-------------------- -------------------- -------------- -------------------- ----------- ----------- ---------- ----------
P03453		     MONITORS			       6 PIECE			       10	    3	   12000      11280
P45123		     CD DRIVE			       2 PIECE			       10	    3	    5250       5100
P35412		     540 HDD			     2.5 PIECE			       10	    3	    8400       8000


